<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>MyPC ヘルプ</title>
        <link rel="stylesheet" href="/css/style.css" />
        <style>
            .horblock {
                display: flex;              
                flex-direction: row;
                padding: 20px;
            }
            figure {
                margin-left: auto;
                margin-right: auto;
                text-align: center;
                font-size:11pt;
                color:firebrick;
            }
            img {
                border: solid thin silver;
            }
            body {
                color: #404040;
            }
        </style>
    </head>

    <body>
        <header>
            <h1><a href="/"><img src="/img/home_green.png" /></a> MyPC ヘルプ</h1>
            <hr />
        </header>
        <article>
        <div class="horblock">
            <div style="width:25%;background-color: ghostwhite;">
                <ol>
                    <li><a href="#はじめに">はじめに</a></li>
                    <li><a href="#インストール">インストール</a></li>
                    <li><a href="#画面">画面</a></li>
                    <li><a href="#HOW-TO">HOW-TO</a></li>
                </ul>
                </div>
            <div style="padding:10px;background-color: white;">
                <!-- はじめに -->
                <h2><a id="はじめに">はじめに</a></h2>
                <p>Chrome Book やタブレット、スマートフォンではディスク容量が小さく、動画や大量の音楽ファイルを持つことができません。
                    家庭内で一人で使うことを前提にこれらの低性能マシンでもメインマシンの大量の動画ファイルなどを利用できるようにしたいと思って開発してみました。</p>
                <p>そのため、ログイン画面や排他処理のようなことはしていません。</p>
                <p>想定する動作環境ですが、次のようなものを想定しています。</p>
                <ul>
                    <li>MyPC を動作させるマシン
                        <ul>
                        <li>大容量ディスクが接続された Windows デスクトップ機</li>
                        <li>大容量ディスクが接続された Linux サーバ機</li>
                        </ul>
                    </li>
                    <li>クライアント
                        <ul>
                        <li>小容量 SSD 搭載の Windows ノート機</li>
                        <li>Chrome Book</li>
                        <li>スマートフォン</li>
                        <li>タブレット (Amazon Fire タブレットも含む)</li>
                        </ul>
                    </li>
                </ul>
                <p>(参考) MyPC は家庭内 LAN だけでなくグローバルなインターネット環境でも原理的には使用可能ですが、次のような問題があります。</p>
                <ul>
                    <li>ルータを操作してポートを外部へ開放する必要がある。</li>
                    <li>グローバル IP アドレスは固定でないので、その都度確認が必要だし、通信中に変わってしまうこともあり得る。</li>
                    <li>ユーザや接続マシンの識別機能がないのでセキュリティ上の問題がある。</li>
                    <li>SSL (https) 対応でないので、通信の中身が丸見えになる。</li>
                </ul>
                <p>&nbsp;</p>

                <!-- インストール -->
                <h2><a id="インストール">インストール</a></h2>
                <!-- インストール / 動作条件 -->
                <h3>動作条件</h3>
                <p>下記の通り。</p>
                <ul>
                    <li>Windows 10 以上または Linux </li>
                    <li>Node.js 10.0 以上</li>
                    <li>MySQL 5.x または MariaDB 10.x 以上</li>
                </ul>
                <!-- インストール / インストール手順 -->
                <h3>インストール手順</h3>
                <p>GitHub から clone を行います。</p>
                <pre class="src">git clone https://github.com/makandat/express</pre>
                <p>express フォルダに MyPC フォルダがあるのでそれをそのまま使ってもいいし、どこかへ移動しても構いません。他のフォルダは不要なので削除して構いません。</p>
                <p>MyPC フォルダへ移動して必要なモジュールをインストールします。</p>
                <pre class="src">npm install</pre>
                <p>実行環境に合わせて mysql.json を編集します。必要ならデータベースとユーザを作成します。(デフォルトではデータベースもユーザも 'user' になっています。)</p>
                <p>MySQL クライアントから create_tables.sql, create_procs.sql を実行して、テーブルとプロシージャを作成します。</p>
                <p>folders.json は MyPC を実行するコンピュータのフォルダ（表示したい）に変更する必要があります。また、textfiles.json も必要なら変更します。</p>
                <p>&nbsp;</p>

                <!-- 画面 -->
                <h2><a id="画面">画面</a></h2>
                <p></p>
                <figure><img src="/img/help/index.jpg" style="width:100%;" /><figcaption>トップぺージ (Android の場合)</figcaption></figure>
                <br />
                <h3>アルバム</h3>
                <p>アルバムはテーブルに登録した項目の集合です。アルバムの項目は同じテーブルの項目でなければなりません。例えば、１つのアルバムに動画と文書が混在してはいけません。</p>
                <p>アルバムグループは仲間のアルバムの集合です。アルバムグループはアルバムの登録時に指定します。</p>
                <h4>例</h4>
                <ul>
                    <li>アルバムグループ：国内旅行の撮影動画
                        <ul>
                            <li>アルバム：北海道旅行 2020年</li>
                            <li>アルバム：沖縄旅行 2020年</li>
                            <li>アルバム：大阪・京都旅行 2021年</li>
                        </ul>
                    </li>
                </ul>
                <p>中央のアイコン (コンピュータ、プロジェクト、・・) はそれぞれのアルバムを開きます。一方、メニューバーの画像、動画などのメニューはデータベースの紐づけられたテーブル内容を直接表示します。</p>
                <br />
                <!-- 画面 / コンピュータ -->
                <h3>コンピュータ</h3>
                <p>これは MyPC を実行しているコンピュータ、つまりホストのディレクトリ構造を表示します。そして、ディレクトリに含まれるファイルの各種情報を表示します。</p>
                <p>それらのファイル (テキストファイルや画像ファイルのみ) の内容を表示したり、ダウンロードできます。</p>
                <p>さらに、簡単なファイル操作も可能です。</p>
                <p>次の画像は「コンピュータ」画面のスクリーンショットです。(ホストは Raspberry Pi4 (Ubuntu Server で運用))</p>
                <figure><img src="/img/help/computer.jpg" /></figure>
                <br />
                <!-- 画面 / プロジェクト -->
                <h3>プロジェクト</h3>
                <p>「プロジェクト」は MySQL のテーブル Projects に紐づけられたデータ一覧を表示したり管理できます。</p>
                <p>プロジェクトはアルバムを作って複数のプロジェクトをまとめて管理できますが、アルバムを作ることは必須ではありません。</p>
                <p>プロジェクトとは別の見方をすれば、ユーザが作業により作り出した「成果物」です。具体的には、プログラミングでのプロジェクトフォルダやある目的で作った計画書、報告書、提案書、配布資料などをまとめたフォルダです。</p>
                <p>プロジェクトはフォルダ単位で管理します。</p>
                <br />
                <!-- 画面 / 文書 -->
                <h3>文書</h3>
                <p>「文書」は MySQL の Documents テーブルに紐づけられた PDF、オフィス文書、テキストファイルなどで、ファイル単位に管理します。</p>
                <p>文書はアルバムを作って複数の文書をまとめて管理できますが、アルバムを作ることは必須ではありません。</p>
                <p>PDF ファイルとテキストファイルはブラウザ内で表示できますが、オフィス文書はダウンロードしてから Office アプリケーションで開きます。</p>
                <p>文書は具体的には、受領資料、ダウンロードした PDF ファイル、メールに添付されてきたオフィス文書などで、自分で作ったものでなくダウンロードしたり、外部から受け取った資料などです。</p>
                <br />
                <!-- 画面 / 画像 -->
                <h3>画像</h3>
                <p>「画像」は MySQL の Pictures テーブルに紐づけられた画像ファイル (.jpg, .png, .gif) を含むフォルダです。つまり、画像ファイルでなくフォルダ単位で管理されます。</p>
                <p>画像はアルバムを作って複数の画像フォルダをまとめて管理できますが、アルバムを作ることは必須ではありません。</p>
                <p>画像フォルダは「親 / 子 / 孫」の関係になっていると一括登録が可能です。具体的な例を示すと「カメラ / 旅行 / 2021年沖縄旅行」のようにします。</p>
                <p>画像フォルダ内の画像はサムネール表示、ナビゲート表示、一括表示などが可能です。</p>
                <p>下の画像はホストの動画をスマートフォン (Android) の Chrome で表示中のものです。
                    この画像はスマートフォンでスクリーンショットをボリューム下げボタン＋電源ボタン同時押しで取得し、MyPC のアップロード機能でホストに取り込みました。</p>
                <figure><img src="/img/help/picture_viewer.jpg" /></figure>
                <br />
                <!-- 画面 / 動画 -->
                <h3>動画</h3>
                <p>「動画」は MySQL の Videos テーブルに紐づけられた動画ファイルです。動画ファイルの形式は .mp4 のみブラウザ内で表示できますが、それ以外の形式は、ダウンロードしてから動画再生アプリで表示する必要があります。</p>
                <p>そのため、.mp4 以外の動画は .mp4 に変換しておくことをお勧めします。具体的にはオンラインで変換できる無料サイトがあります。</p>
                <p>動画はアルバムを作って複数の動画ファイルをまとめて管理できますが、アルバムを作ることは必須ではありません。</p>
                <p>下の画像はホストの動画をスマートフォン (Android) の Chrome で再生中のものです。
                    この画像はスマートフォンでスクリーンショットをボリューム下げボタン＋電源ボタン同時押しで取得し、MyPC のアップロード機能でホストに取り込みました。</p>
                <figure><img src="/img/help/video_play.jpg" /></figure>
                <br />
                <!-- 画面 / 音楽 -->
                <h3>音楽</h3>
                <p>「音楽」は MySQL の Music テーブルに紐づけられた音楽ファイルです。音楽ファイルの形式は .mp3 がブラウザ内で再生できますが、それ以外の形式は、ダウンロードしてから動画再生アプリで表示する必要があります。(Chrome は .m4a も再生できる)</p>
                <p>そのため、.mp3 以外の音楽は .mp3 に変換しておくことをお勧めします。具体的にはオンラインで変換できる無料サイトがあります。</p>
                <p>音楽はアルバムを作って複数の音楽ファイルをまとめて管理できますが、アルバムを作ることは必須ではありません。</p>
                <p>音楽ファイルはプレイリストを作ることができます。プレイリストは音楽テーブルやアルバムテーブルから独立しているので、推奨はしませんがプレイリストのみに音楽ファイルを登録しておくこともできます。</p>
                <p>下の画像はホストの音楽をスマートフォン (Android) の Chrome で演奏中のものです。</p>
                <figure><img src="/img/help/music_play.jpg" /></figure>
                <p></p>
                <br />
                <!-- 画面 / その他 -->
                <h3>その他</h3>
                <p>「その他」では以下のことが可能です。</p>
                <ul>
                    <li>サムネール画像の登録と管理</li>
                    <li>テーブルのバックアップと管理</li>
                    <li>レコード識別マークの管理</li>
                    <li>テーブルのデータ削除 (id を指定して)</li>
                    <li>テーブルのデータの一括削除 (id の範囲を指定して)</li>
                    <li>テーブルのレコードのパス (path) の一括変更</li>
                    <li>データ一括登録とチェック</li>
                    <li>パスの存在チェック (id の範囲を指定して)</li>
                    <li>ファイルリストからの一括データ登録</li>
                    <li>タイトルの一括変更</li>
                    <li>タイマー (アクセサリ)</li>
                    <li>/img フォルダの画像一括表示 (アクセサリ)</li>
                </ul>
                <br />
                <p>&nbsp;</p>
                <!-- HOW-TO -->
                <h2><a id="HOW-TO">HOW-TO</a></h2>
                <!-- サムネール画像の作成と登録 -->
                <h3>サムネール画像の作成と登録</h3>
                <p>サムネール画像を登録しておくと、アルバムや動画のイメージが直感的につかみやすくなります。</p>
                <p>サムネール画像を登録するには、その画像ファイルを作成して「その他」アイコンの中の「サムネール画像の追加と修正」で登録します。</p>
                <p>サムネール画像は Windows の「切り取り＆スケッチ」アプリで画面の一部を切り取って Paint などで縮小 (100 x 100 くらいまで) で作ります。</p>
                <p>サムネール画像を登録するとその id が表示されるので、サムネールを紐づけしたい項目の変更画面を表示して「サムネール」にその id を入力してそのデータを更新します。</p>
                <p>&nbsp;</p>
                <!-- ファイルのフルパスの取得 -->
                <h3>ファイルのフルパスの取得</h3>
                <p>ファイルのフルパスは「コンピュータ」でそのファイルを含むディレクトリの中身一覧を表示して、No.の番号をクリックするとそのファイルのフルパスを取得できます。</p>
                <p>ディレクトリの場合は、Windows ならそのディレクトリをクリックすると Explorer のアドレスバーにフルパスが表示されるので、コピーして使えます。もちろん、「コンピュータ」でファイルのフルパスを取得したのと同様にしても取得できます。</p>
                <p>コマンドプロンプトに Explorer からファイルをドラッグ＆ドロップすると、そのファイルがコマンドプロンプトに表示されるので、それをコピーする方法もあります。</p>
                <p>&nbsp;</p>
                <!-- データの削除 -->
                <h3>データの削除</h3>
                <p>「その他」の中にデータの削除機能があります。ここでは、削除前に確認メッセージが表示されるので、安全に削除ができます。</p>
                <p>&nbsp;</p>
                <!-- フォルダの移動 -->
                <h3>フォルダの移動</h3>
                <p>テーブルに登録されたパスを別の場所へ移動した場合、ディレクトリの一部を変更することにより、テーブルの内容と物理的なディレクトリの整合性を確保できます。</p>
                <p>これは、「その他」の中の「テーブルのレコードのパス (path) の一括変更」で行うことができます。ここでは変更前に必ず「確認」を行うので、安全に変更できます。</p>
                <p>&nbsp;</p>
                <!-- データ入力時の注意 -->
                <h3>データ入力時の注意</h3>
                <p>フォームでデータを入力する場合、例えば「画像」なら「作者」、音楽なら「アーティスト」などの項目があります。これらには、必ずしも「作者」や「アーティスト」を入力する必要はありません。</p>
                <p>これらは単に分類をしやすくするための項目なので、音楽ならアーティスト (演奏者) でなく作曲者 (例えばベートーベン) などを設定しても構いませんし、画像なら作者の代わりにカメラの機種名などを設定しても構いません。</p>
                <p>&nbsp;</p>
                <!-- パス名の制限 -->
                <h3>パス名の制限</h3>
                <p>次の文字を含むパスを指定した場合、正しく動作しないので<u>パス名を変更する必要があります。</u></p>
                <p style="color:blue;margin-left:5%;">#&+*%?\</p>
                <p>&nbsp;</p>
                <!-- ログの参照と削除 -->
                <h3>ログの参照と削除</h3>
                <p>デバッグモードで実行中、ログ (mypc.log) が ./tmp の中に作られます。これは不要なら手動で削除する必要があります。なお、ログが追加されるタイミングは一括登録などの一括操作のときだけです。</p>
                <p>&nbsp;</p>
                <!-- データベーステーブルのエクスポートとインポート -->
                <p>Windows の場合は、HeidiSQL (MariaDB のインストールで同時にインストールされる) などの GUI ツールを使うと簡単にエクスポートとインポートが可能です。</p>
                <p>mysql クライアントを使う場合、エクスポート用 SELECT INTO OUTFILE コマンドはセキュリティ上の理由で使えなくなったそうです。
                インポート用 LOAD DATA INFILE コマンドは使えるそうです。</p>
                <p>mysql コマンドで -e オプションとリダイレクトを使い、テーブル内容をファイル保存することはできます。</p>
                <pre>mysql -h localhost -u user -D user -p -s -r -e "SELECT * FROM Projects LIMIT 10" &gt; /home/user/temp/Projects.txt</pre>
            </div>
        </div>
    </article>
    <footer>
        <p>&nbsp;</p>
        <p class="footer_text"><a href="#top">TOP</a></p>
        <p>&nbsp;</p>
        <p>&nbsp;</p>
    </footer>
    </body>
</html>